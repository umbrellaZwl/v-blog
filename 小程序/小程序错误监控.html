<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小程序错误监控 | My VuePress Blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="Just playing around">
    <link rel="preload" href="/v-blog/assets/css/0.styles.c69a4523.css" as="style"><link rel="preload" href="/v-blog/assets/js/app.1743548a.js" as="script"><link rel="preload" href="/v-blog/assets/js/2.e1956d27.js" as="script"><link rel="preload" href="/v-blog/assets/js/5.c4d3a014.js" as="script"><link rel="prefetch" href="/v-blog/assets/js/10.1cd9308e.js"><link rel="prefetch" href="/v-blog/assets/js/11.34d483fc.js"><link rel="prefetch" href="/v-blog/assets/js/12.09e4a50b.js"><link rel="prefetch" href="/v-blog/assets/js/13.bd8d0cbb.js"><link rel="prefetch" href="/v-blog/assets/js/14.2b53bef7.js"><link rel="prefetch" href="/v-blog/assets/js/15.6696cc7d.js"><link rel="prefetch" href="/v-blog/assets/js/16.d9f58607.js"><link rel="prefetch" href="/v-blog/assets/js/17.f559b40e.js"><link rel="prefetch" href="/v-blog/assets/js/18.2260598d.js"><link rel="prefetch" href="/v-blog/assets/js/19.88fa5de9.js"><link rel="prefetch" href="/v-blog/assets/js/20.5415cbf3.js"><link rel="prefetch" href="/v-blog/assets/js/21.69e7f98d.js"><link rel="prefetch" href="/v-blog/assets/js/3.b9bbb136.js"><link rel="prefetch" href="/v-blog/assets/js/4.c4bce73f.js"><link rel="prefetch" href="/v-blog/assets/js/6.df08cf57.js"><link rel="prefetch" href="/v-blog/assets/js/7.e73ea1e5.js"><link rel="prefetch" href="/v-blog/assets/js/8.cd1a4b97.js"><link rel="prefetch" href="/v-blog/assets/js/9.3b9b56eb.js">
    <link rel="stylesheet" href="/v-blog/assets/css/0.styles.c69a4523.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/v-blog/" class="home-link router-link-active"><!----> <span class="site-name">My VuePress Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>代码规范</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/v-blog/vscode搭配linter&amp;prettier.html" class="sidebar-link">vscode搭配linter&amp;prettier</a></li></ul></section></li><li><a href="/v-blog/常用代码片段.html" class="sidebar-link">常用代码片段</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Taro</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/v-blog/Taro采坑记录.html" class="sidebar-link">Taro采坑记录</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/v-blog/vue/vue的keep-alive.html" class="sidebar-link">vue的keep-alive</a></li><li><a href="/v-blog/vue/vuex.html" class="sidebar-link">vuex</a></li><li><a href="/v-blog/vue/vue生命周期梳理.html" class="sidebar-link">vue生命周期梳理</a></li><li><a href="/v-blog/vue/vue3响应式原理.html" class="sidebar-link">vue3响应式原理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>小程序</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/v-blog/小程序/小程序生命周期.html" class="sidebar-link">小程序生命周期</a></li><li><a href="/v-blog/小程序/小程序错误监控.html" class="active sidebar-link">小程序错误监控</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/v-blog/小程序/小程序错误监控.html#js错误" class="sidebar-link">JS错误</a></li><li class="sidebar-sub-header"><a href="/v-blog/小程序/小程序错误监控.html#资源加载错误" class="sidebar-link">资源加载错误</a></li><li class="sidebar-sub-header"><a href="/v-blog/小程序/小程序错误监控.html#未处理的rejected态的promise" class="sidebar-link">未处理的rejected态的promise</a></li><li class="sidebar-sub-header"><a href="/v-blog/小程序/小程序错误监控.html#监听打开的页面不存在" class="sidebar-link">监听打开的页面不存在</a></li><li class="sidebar-sub-header"><a href="/v-blog/小程序/小程序错误监控.html#路由切换信息" class="sidebar-link">路由切换信息</a></li><li class="sidebar-sub-header"><a href="/v-blog/小程序/小程序错误监控.html#用户分析" class="sidebar-link">用户分析</a></li><li class="sidebar-sub-header"><a href="/v-blog/小程序/小程序错误监控.html#console信息" class="sidebar-link">console信息</a></li><li class="sidebar-sub-header"><a href="/v-blog/小程序/小程序错误监控.html#接口错误" class="sidebar-link">接口错误</a></li><li class="sidebar-sub-header"><a href="/v-blog/小程序/小程序错误监控.html#自定义上报" class="sidebar-link">自定义上报</a></li><li class="sidebar-sub-header"><a href="/v-blog/小程序/小程序错误监控.html#实现方式" class="sidebar-link">实现方式</a></li></ul></li><li><a href="/v-blog/小程序/小程序调试工具.html" class="sidebar-link">小程序调试工具</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>积累</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/v-blog/积累/浏览器进程和js线程.html" class="sidebar-link">浏览器进程和线程</a></li><li><a href="/v-blog/积累/前端路由.html" class="sidebar-link">前端路由</a></li><li><a href="/v-blog/积累/script标签的async和deffer.html" class="sidebar-link">script标签的async和deffer</a></li><li><a href="/v-blog/积累/Http1.0、Http1.1、Http2.0.html" class="sidebar-link">Http1.0、Http1.1、Http2.0</a></li><li><a href="/v-blog/积累/fetch.html" class="sidebar-link">fetch</a></li><li><a href="/v-blog/积累/BFCache.html" class="sidebar-link">BfCache</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="小程序错误监控"><a href="#小程序错误监控" class="header-anchor">#</a> 小程序错误监控</h1> <h2 id="js错误"><a href="#js错误" class="header-anchor">#</a> JS错误</h2> <p>通过<code>App</code>的<code>onError</code>属性监听全局JS错误。</p> <h4 id="onerror-string-error"><a href="#onerror-string-error" class="header-anchor">#</a> onError(String error)</h4> <p>小程序发生脚本错误或 API 调用报错时触发。也可以使用 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onError.html" target="_blank" rel="noopener noreferrer">wx.onError<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 绑定监听。</p> <p><strong>参数</strong>：与 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onError.html" target="_blank" rel="noopener noreferrer">wx.onError<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 一致</p> <ul><li>和web端window.onError不一样的地方</li></ul> <table><thead><tr><th></th> <th>window.onError</th> <th>App({onError})</th></tr></thead> <tbody><tr><td>回调的形参err</td> <td>形参是一个Error实例</td> <td>形参是e.stack字符串。例如：string MiniProgramErrorthis.hah is not a functionTypeError: this.hah is not a function   at ge.clickJsBtn (http://127.0.0.1:25208/appservice/pages/sdk/sdk.js:11:10)   at Object.n.safeCallback (http://127.0.0.1:25208/appservice/<strong>dev</strong>/WAService.js:2:3057410)   at http://127.0.0.1:25208/appservice/<strong>dev</strong>/WAService.js:2:3228407   at a (http://127.0.0.1:25208/appservice/<strong>dev</strong>/WAService.js:2:3155482)   at http://127.0.0.1:25208/appservice/<strong>dev</strong>/WAService.js:2:3228338   at n (http://127.0.0.1:25208/appservice/<strong>dev</strong>/WAService.js:2:3134502)   at http://127.0.0.1:25208/appservice/<strong>dev</strong>/WAService.js:2:3135079   at http://127.0.0.1:25208/appservice/<strong>dev</strong>/WAService.js:2:1974236   at i (http://127.0.0.1:25208/appservice/<strong>dev</strong>/asdebug.js:1:34164)   at c (http://127.0.0.1:25208/appservice/<strong>dev</strong>/asdebug.js:1:34275)</td></tr> <tr><td>资源错误</td> <td>能捕获</td> <td>无法捕获</td></tr></tbody></table> <h2 id="资源加载错误"><a href="#资源加载错误" class="header-anchor">#</a> 资源加载错误</h2> <p>如上所述，资源错误无法在js层来进行全局监听。可选方案：</p> <ul><li>针对<code>image</code>等媒体组件编写增强版的自定义组件，收集信息（会造成组件层级加深，带来性能损耗）</li> <li>开发者监听<code>image</code>组件<code>error</code>事件，调用API上报.</li></ul> <p>错误信息如图：</p> <p><img src="/v-blog/assets/img/1.5ef5de09.png" alt="img"></p> <h2 id="未处理的rejected态的promise"><a href="#未处理的rejected态的promise" class="header-anchor">#</a> 未处理的rejected态的promise</h2> <p>通过<code>App</code>的<code>onUnhandledRejection</code>监听</p> <h4 id="onunhandledrejection-object-object"><a href="#onunhandledrejection-object-object" class="header-anchor">#</a> onUnhandledRejection(Object object)</h4> <p>基础库 2.10.0 开始支持，低版本需做<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html" target="_blank" rel="noopener noreferrer">兼容处理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>小程序有未处理的 Promise 拒绝时触发。也可以使用 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onUnhandledRejection.html" target="_blank" rel="noopener noreferrer">wx.onUnhandledRejection<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 绑定监听。注意事项请参考 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onUnhandledRejection.html" target="_blank" rel="noopener noreferrer">wx.onUnhandledRejection<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p><strong>参数</strong>：与 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onUnhandledRejection.html" target="_blank" rel="noopener noreferrer">wx.onUnhandledRejection<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 一致</p> <p>形参是一个包含reason和promise的对象。如图：</p> <p><img src="/v-blog/assets/img/2.f533293c.png" alt="img"></p> <h2 id="监听打开的页面不存在"><a href="#监听打开的页面不存在" class="header-anchor">#</a> 监听打开的页面不存在</h2> <h4 id="onpagenotfound-object-object"><a href="#onpagenotfound-object-object" class="header-anchor">#</a> onPageNotFound(Object object)</h4> <p>基础库 1.9.90 开始支持，低版本需做<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html" target="_blank" rel="noopener noreferrer">兼容处理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>小程序要打开的页面不存在时触发。也可以使用 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onPageNotFound.html" target="_blank" rel="noopener noreferrer">wx.onPageNotFound<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 绑定监听。注意事项请参考 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onPageNotFound.html" target="_blank" rel="noopener noreferrer">wx.onPageNotFound<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p><strong>参数</strong>：与 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onPageNotFound.html" target="_blank" rel="noopener noreferrer">wx.onPageNotFound<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 一致</p> <p><strong>注意：</strong></p> <p><strong>1、该回调只能监听本次启动的入口页不存在的场景。对于wx.navigateTo等路由跳转的页面无法监听</strong></p> <p><strong>2、</strong><code>且调用wx``.``navigateTo``()</code>打开一个不存在的页面，会被navigateTo回调监听，如果<code>success</code>和<code>fail</code>回调都没有设置，则会被<code>App({onUnhandledRejection})</code>监听到</p> <h3 id="组件事件信息"><a href="#组件事件信息" class="header-anchor">#</a> 组件事件信息</h3> <p>由于小程序和web端本身属于两种不同的体系和容器，小程序基于解析特有的文件组织结构和组件系统来开发，没有DOM和BOM，在事件系统上差异比较大的</p> <table><thead><tr><th></th> <th>web端</th> <th>小程序端</th></tr></thead> <tbody><tr><td>事件流</td> <td>统一的捕获-&gt;自身-&gt;冒泡</td> <td>事件发生在组件上，分冒泡事件和非冒泡事件。基础库1.5.0后触摸类事件支持捕获阶段<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#%E4%BA%8B%E4%BB%B6%E8%AF%A6%E8%A7%A3" target="_blank" rel="noopener noreferrer">https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#%E4%BA%8B%E4%BB%B6%E8%AF%A6%E8%A7%A3<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td></tr> <tr><td>能否全局监听</td> <td>通过window.addEventListener在捕获阶段监听</td> <td>只能在组件上绑定，无法全局监听</td></tr> <tr><td></td> <td></td> <td></td></tr></tbody></table> <ul><li>方案一：开发者自行在页面的<code>wxml</code>的最外层容器view绑定捕获事件，并调用sdk的api手动发送</li> <li>方案二：开发一个自定义组件，用于包裹页面<code>wxml</code></li></ul> <h2 id="路由切换信息"><a href="#路由切换信息" class="header-anchor">#</a> 路由切换信息</h2> <ul><li>通过改写<code>wx</code>的路由方法来收集信息https://developers.weixin.qq.com/miniprogram/dev/api/route/wx.switchTab.html</li></ul> <p>同时可以在跳转时当前页面url（来源）和跳转url（目标）</p> <ul><li><p>包括以下方法：</p></li> <li><ul><li>wx.switchTab</li> <li>wx.reLaunch</li> <li>wx.redirectTo</li> <li>wx.navigateTo</li> <li>wx.navigateBack</li></ul></li></ul> <p>微信下面的这些方法是readonly的 无法修改</p> <h2 id="用户分析"><a href="#用户分析" class="header-anchor">#</a> 用户分析</h2> <ul><li>通过对<code>App</code>和<code>Page</code>的入参进行包裹后提供包裹后的结果或通过覆盖<code>App</code>和<code>Page</code>全局变量来监听onShow，onLoad，onShareMessage等生命周期函数，来收集pv,uv信息。</li> <li>同时也需要提供自定义的上报方法调用</li></ul> <h2 id="console信息"><a href="#console信息" class="header-anchor">#</a> console信息</h2> <table><thead><tr><th>web端</th> <th>小程序</th></tr></thead> <tbody><tr><td>console作为window的一个属性挂在window下</td> <td>小程序环境内的全局变量</td></tr> <tr><td></td> <td></td></tr></tbody></table> <ul><li>可通过覆盖全局console来收集信息。要注意的是覆盖的是全局变量<code>console</code>不是<code>wx.console</code></li> <li>提供增强版的console</li></ul> <h2 id="接口错误"><a href="#接口错误" class="header-anchor">#</a> 接口错误</h2> <p>通过重写wx.request、wx.downloadFile来收集信息</p> <p>wx.request和wx.downloadFile等方法是readonly的</p> <h2 id="自定义上报"><a href="#自定义上报" class="header-anchor">#</a> 自定义上报</h2> <p>通过提供sdk常见的一些上报方法进行收集</p> <h2 id="实现方式"><a href="#实现方式" class="header-anchor">#</a> 实现方式</h2> <table><thead><tr><th>通过监听重写api。<code>wx.onPageShow</code>等方式https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onUnhandledRejection.html</th> <th>通过提供函数接受options对象返回新的options对象给App和Page调用。参考阿里云ARMShttps://help.aliyun.com/document_detail/103992.html#title-woy-xao-u0c</th> <th>通过覆盖<code>App</code>, <code>Page</code>等全局变量参考百度移动统计https://mtj.baidu.com/web/overview?appId=3017112</th></tr></thead> <tbody><tr><td>只能监听应用级事件</td> <td>灵活，但需要开发者手动写一些代码，且不能适配taro等框架（因为框架层都是基于组件开发，然后在编译阶段调用App传入options对象）</td> <td>引入即可上报，无需用户额外添加逻辑。且理论上可适配任何小程序框架（待测试）缺点：代码需要在App.js中最顶部引入</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/v-blog/小程序/小程序生命周期.html" class="prev">
        小程序生命周期
      </a></span> <span class="next"><a href="/v-blog/小程序/小程序调试工具.html">
        小程序调试工具
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/v-blog/assets/js/app.1743548a.js" defer></script><script src="/v-blog/assets/js/2.e1956d27.js" defer></script><script src="/v-blog/assets/js/5.c4d3a014.js" defer></script>
  </body>
</html>
